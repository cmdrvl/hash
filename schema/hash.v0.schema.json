{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "hash.v0",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "const": "hash.v0"
    },
    "path": {
      "type": "string",
      "description": "Absolute file path"
    },
    "bytes_hash": {
      "type": [
        "string",
        "null"
      ],
      "pattern": "^(sha256|blake3):[a-f0-9]{64}$",
      "description": "Cryptographic hash with algorithm prefix"
    },
    "hash_algorithm": {
      "type": [
        "string",
        "null"
      ],
      "enum": [
        "sha256",
        "blake3"
      ]
    },
    "tool_versions": {
      "type": "object",
      "additionalProperties": {
        "type": "string"
      }
    },
    "_skipped": {
      "type": "boolean",
      "description": "True if file could not be hashed"
    },
    "_warnings": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "tool": {
            "type": "string"
          },
          "code": {
            "type": "string"
          },
          "message": {
            "type": "string"
          },
          "detail": {
            "type": "object"
          }
        }
      }
    }
  },
  "required": [
    "version",
    "path",
    "bytes_hash",
    "hash_algorithm",
    "tool_versions"
  ]
}
